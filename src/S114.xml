<?xml version="1.0" encoding="UTF-8" ?>
<section xml:id="s-gcds-and-zsubn">
<title>Greatest Common Divisors  and the Integers Modulo <m>n</m></title>
 
<introduction><p>In this section introduce the greatest common divisor operation, and  introduce an important family of concrete groups, the integers modulo <m>n</m>. </p></introduction>

<subsection xml:id="ss-greatest-common-divisors"><title>Greatest Common Divisors</title>


<p>We start with a theorem about integer division that is intuitively clear.  We leave the proof as an  exercise.</p>

<theorem xml:id="th-division-property"><title>The Division Property for Integers</title>
<idx>Division Property for Integers</idx>
<statement><p>If <m>m, n\in \mathbb{Z}</m>, <m>n>0</m>, then there exist two unique integers, <m>q</m> (the quotient) and <m>r</m> (the remainder), such that <m>m = n q + r</m> and <m>0 \leq  r &lt; n</m>.</p></statement></theorem>

<note><p>The division property says that if <m>m</m> is divided by <m>n</m>, you will obtain a quotient and a remainder, where the remainder is less than <m>n</m>. This is a fact that most elementary school students learn when they are introduced to long division. In doing the division problem <m>1986 \div  97</m>, you obtain a quotient of 20 and a remainder of 46.  This result could either be written <m>\frac{1986}{97}= 20+\frac{46}{97}</m> or  <m>1986 = 97\cdot 20 + 46</m>.  The latter form is how the division property is normally expressed in higher mathematics.</p></note>

<list xml:id="divisability-terms"><title/>
<introduction><p>We now remind the reader of some interchangeable terminology that is used when 
 <m>r=0</m>, i. e.,  <m>a = b q</m>.  All of the following say the same thing, just from slightly different points of view.</p></introduction>
 <dl>
 <li><title>divides</title><p><m>b</m> divides <m>a</m></p></li>
 <li><title>multiple</title><p><m>a</m> is a multiple of <m>b</m></p></li>
 <li><title>factor</title><p><m>b</m> is a factor of <m>a</m></p></li>
 <li><title>divisor</title><p><m>b</m> is a divisor of <m>a</m></p></li>
</dl>
<conclusion><p> We use the notation   <m>b \mid a</m>  if  <m>b</m>  divides <m>a</m>.</p></conclusion>
</list>


<p> For example  <m>2\mid 18</m>   and <m>9\mid 18</m> ,
but  <m>4\nmid 18</m>.</p>

<p>Caution:  Don't confuse the <q>divides</q> symbol with the <q>divided by</q> symbol.  The former is vertical while the latter is slanted.   Notice however that the statement <m>2 \mid 18</m> is related to the fact that <m>18/2</m> is a whole number.</p>

<definition xml:id="def-gcd"><title>Greatest Common Divisor</title>
<idx>Greatest Common Divisor (<m>\gcd</m>) </idx>
<notation><usage><m>\gcd(a,b)</m></usage><description>the greatest common divisor of <m>a</m> and <m>b</m></description></notation><statement><p>Given two integers, <m>a</m> and <m>b</m>, not both zero, the greatest common divisor of <m>a</m> and <m>b</m> is the positive integer
<m>g=\gcd(a,b)</m> such that  <m>g \mid a</m>,  <m>g\mid b</m>, and
<me> c\mid a \textrm{ and } c \mid b \Rightarrow c \mid g</me>
</p></statement></definition>


<p>A little simpler way to think of <m>\gcd(a,b)</m> is as the largest positive integer that is a divisor of both <m>a</m> and <m>b</m>.  However, our definition is easier to apply in proving properties of greatest common divisors.</p>

<p>For small numbers, a simple way to determine the greatest common divisor is to use factorization.  For example if we want the greatest common divisor of 660 and 350, you can factor the two integers:  <m>660=2^2\cdot 3\cdot 5\cdot 11</m> and <m>350 = 2 \cdot 5^2\cdot 7</m>.     Single factors of 2 and 5 are the only ones that appear in both factorizations, so the greatest common divisor is <m>2\cdot 5 =10</m>.</p>


<p>Some pairs of integers have no common divisors other than 1.  Such pairs are called <em>relatively prime
pairs</em>.</p>
<definition xml:id="def-def-rel-prime"><title>Relatively Prime</title>
<idx>Relatively Prime</idx>
<statement><p>A pair of integers, <m>a</m> and <m>b</m>, are relatively prime if <m>\gcd(a, b)=1</m></p></statement></definition>

<p>For example, <m>128=2^7</m> and <m>135=3^3\cdot 5</m> are relatively prime.    Notice that neither 128 nor 135 are primes.   In general, <m>a</m> and <m>b</m> need not be prime in order to be relatively prime.  However, if you start with a prime, like 23, for example, it will be relatively prime to everything but its multiples.  This theorem, which we prove later, generalizes this observation.</p>

<theorem xml:id="th-primes-are-mostly-relprime">
<statement><p>If <m>p</m> is a prime and <m>a</m> is any integer such that <m>p\nmid a</m>  then <m>\gcd(a, p) = 1</m></p></statement></theorem>

</subsection>
<subsection xml:id="sss-euclidean-algorithm"><title>The Euclidean Algorithm</title><idx>Euclidean Algorithm, The </idx>

<p>As early as Euclid's time it was known that factorization wasn't the best way to compute greatest common divisors.</p>
<p>The Euclidean Algorithm is based on the following properties of the greatest common divisor.
<mdn>
<mrow xml:id="eq-euclid-basis">\gcd(a,0)= a \textrm{  for  } a\neq 0</mrow>
<mrow xml:id="eq-euclid-recursion">\gcd(a, b)= \gcd(b, r)\textrm{   if } b\neq 0\textrm{   and }a = b q + r</mrow>
</mdn></p>

<p>To compute <m>\gcd(a,b)</m>, we divide <m>b</m> into <m>a</m> and get a remainder <m>r</m> such that <m>0\leq  r &lt;\lvert b\rvert </m>.  By the property above, <m>\gcd(a, b)= \gcd(b, r)</m>.  We repeat the process until  we get zero for a remainder.  The last nonzero number that is the second entry in our pairs is the greatest common divisor.   This is inevitable because the second number in each pair is smaller than the previous one.  <xref ref="table-euclidean-example" text="type-global" /> shows an example of how this calculation can be systematically performed.</p>

<table   xml:id="table-euclidean-example">
<title>A Table to Compute <m>\gcd(99,53)</m></title>
<tabular halign="center">
<row><cell><m>q</m></cell><cell><m>a</m></cell><cell><m>b</m></cell></row>
<row><cell>-</cell><cell>99</cell><cell>53</cell></row>
<row><cell>1</cell><cell>53</cell><cell>46</cell></row>
<row><cell>1</cell><cell>46</cell><cell>7</cell></row>
<row><cell>6</cell><cell>7</cell><cell>4</cell></row>
<row><cell>1</cell><cell>4</cell><cell>3</cell></row>
<row><cell>1</cell><cell>3</cell><cell>1</cell></row>
<row><cell>3</cell><cell>1</cell><cell>0</cell></row>
</tabular>
</table>

<p>Here is a Sage computation to verify that <m>\gcd(99, 53) = 1</m>.   At each line, the value of <m>a</m> is divided by the value of <m>b</m>.   The quotient is placed on the next line along with the new value of <m>a</m>, which is the previous <m>b</m>; and the remainder, which is the new value of <m>b</m>.  Recall that in Sage, <c>a%b</c> is the remainder when dividing <c>b</c> into <c>a</c>. </p>
<sage>
<input>
a=99
b=53
while b>0:
    print('computing gcd of '+str(a)+' and '+str(b))
    [a,b]=[b,a%b]
print('result is '+str(a))</input>
<output>
computing gcd of 99 and 53
computing gcd of 53 and 46
computing gcd of 46 and 7
computing gcd of 7 and 4
computing gcd of 4 and 3
computing gcd of 3 and 1
result is 1
</output>
</sage>

<investigation><statement><p>If you were allowed to pick two integers less than 100, which would you pick in order to force Euclid to work hardest? Here's a hint:  The size of the quotient at each step determines how quickly the numbers decrease.</p> </statement><solution><p>If quotient in division is 1, then we get the slowest possible completion.   If <m>a = b + r</m>, then working backwards, each remainder would be the sum of the two previous remainders.  This described a sequence like the Fibonacci sequence and indeed, the greatest common divisor of two consecutive Fibonacci numbers will take the most steps to reach a final value of 1.</p>
</solution></investigation> 



<p>For fixed values of <m>a</m> and <m>b</m>, consider integers of the form <m>a x+b y</m> where <m>x</m> and <m>y</m> can be any two integers.  For example if <m>a</m> = 36 and <m>b</m> = 27,  some of these results are tabulated below with <m>x</m> values along the left column
and the <m>y</m> values on top.</p>
  <figure xml:id="fig-integer-linear-comb">
                <caption>Linear combinations of 36 and 27
                </caption>
                <image width="75%" source="images/fig-integer-linear-comb.png">
                    <description>Linear combinations of 36 and 27</description>
                </image>
            </figure>
<p>Do you notice any patterns?   What is the smallest positive value that you see in this table?  How is it connected to 36 and 27?</p>

<theorem xml:id="theorem-11-4-1"><title>Bézout's lemma</title><idx> Bézout's lemma</idx>
<statement><p>If <m>a</m> and <m>b</m> are positive integers, the smallest positive value of <m>a x + b y</m> is the greatest common
divisor of <m>a</m> and <m>b</m>, <m>\gcd(a,b)</m>.</p></statement>
<proof><p>If  <m>g = \gcd(a, b)</m>, since <m>g \mid a</m> and  <m>g \mid b</m>, we know that  <m>g \mid (a x + b y)</m> for any integers <m>x</m> and <m>y</m>, so <m>a x + b y</m> can't be less than <m>g</m>.  To show that <m>g</m> is exactly the least positive value, we show that <m>g</m> can be attained by extending the Euclidean Algorithm.  Performing the extended algorithm involves building a table of numbers.  The way in which it is built  maintains an invariant, and by <xref ref="th-invariant-relation-theorem" text="title" />, we can be sure that the desired values of <m>x</m> and <m>y</m> are produced. </p>
</proof></theorem>


  



<p>To illustrate the algorithm, <xref ref="table-x-euclidean-example" text="type-global" /> displays how to compute
 <m>\gcd(152,53)</m>.   In the <m>r</m> column, you will find 152 and 53, and then the successive remainders from division.  So each number in <m>r</m> after the first two is the remainder after dividing the number immediately above it into the next number up.  To the left of each remainder is the quotient from the division.  In this case the third row of the table tells us that <m>152 = 53\cdot 2 + 46</m>. The last nonzero value in <m>r</m> is the greatest common divisor.  </p>

<table   xml:id="table-x-euclidean-example">
<title>The extended Euclidean algorithm to compute <m>\gcd(152,53)</m></title>
<tabular top="major" halign="center">
<row><cell><m>q</m></cell><cell><m>r</m></cell><cell><m>s</m></cell><cell><m>t</m></cell></row>
<row><cell><m>--</m></cell><cell>152</cell><cell>1</cell><cell>0</cell></row>
<row><cell><m>--</m></cell><cell>53</cell><cell>0</cell><cell>1</cell></row>
<row><cell>2</cell><cell>46</cell><cell>1</cell><cell><m>-2</m></cell></row>
<row><cell>1</cell><cell>7</cell><cell><m>-1</m></cell><cell>3</cell></row>
<row><cell>6</cell><cell>4</cell><cell>7</cell><cell><m>-20</m></cell></row>
<row><cell>1</cell><cell>3</cell><cell><m>-8</m></cell><cell>23</cell></row>
<row><cell>1</cell><cell>1</cell><cell>15</cell><cell><m>-43</m></cell></row>
<row><cell>3</cell><cell>0</cell><cell><m>-53</m></cell><cell>152</cell></row>
</tabular>
</table>

<p>The <q><m>s</m></q> and <q><m>t</m></q> columns are new.  The values of <m>s</m> and <m>t</m> in each row are maintained so that <m>152s + 53t</m> is equal to the number in the <m>r</m> column.   Notice that</p>

<table   xml:id="table-invariants-11">
<title>Invariant in computing <m>\gcd(152,53)</m></title>
<tabular  halign="center">
<row><cell><m>152 = 152\cdot 1+ 53\cdot 0</m></cell></row>
<row><cell><m>53 =152\cdot 0 + 53\cdot 1</m></cell></row>
<row><cell><m>46 = 152\cdot 1 + 53\cdot (-2)</m></cell></row>
<row><cell><m>\vdots</m></cell></row>
<row><cell><m>1 = 152\cdot 15 + 53\cdot (-43)</m></cell></row>
<row><cell><m>0 = 152 \cdot (-53) + 53\cdot 152</m></cell></row>
</tabular>
</table>
<p>The next-to-last equation is what we're looking for in the end!  The main problem is to identify how to determine these values after the first two rows.  The first two rows in these columns will always be the same. Let's look at the general case of computing <m>\gcd(a,b)</m>.  If the <m>s</m> and <m>t</m> values in rows <m>i - 1</m> and  <m>i - 2</m> are correct, we have



  <me>(A)\textrm{        }\left\{
\begin{array}{c}
 a s_{i-2}+b t_{i-2}=r_{i-2} \\
 a s_{i-1}+b t_{i-1}=r_{i-1} \\
\end{array}
\right.</me>

In addition, we know that


<me>r_{i-2}=r_{i-1} q_i+r_i\textrm{    }\Rightarrow \textrm{     }r_i=r_{i-2}-r_{i-1} q_i</me>



If you substitute the expressions for <m>r_{i-1}</m> and <m>r_{i-2}</m> from (A) into this last equation and then collect the <m>a</m> and <m>b</m> terms separately you get
<me>r_i= a\left(s_{i-2}- q_is_{i-1}\right) + b\left(t_{i-2} - q_it_{i-1}\right)</me>

or

<me>s_{i }=s_{i-2}- q_is_{i-1}\textrm{  and  } t_i= t_{i-2} - q_it_{i-1}</me>

Look closely at the equations for <m>r_i, s_i, \textrm{ and } t_i</m>.  Their forms are all the same.  With a little bit of practice you should be able
to compute <m>s</m> and <m>t</m> values quickly.</p>

</subsection>
<subsection xml:id="ss-modular-arithmetic"><title>Modular Arithmetic</title><idx>Modular Arithmetic</idx>
<p>We remind you of the relation on the integers that we call <xref ref="def-congruence-mod-n" text="title" />.  If two integers, <m>a</m> and <m>b</m>, differ by a multiple of <m>n</m>, we say that they are congruent modulo <m>n</m>, denoted <m>a \equiv  b\pmod{n}</m>. For example, <m>13 \equiv  38\pmod{5}</m> because <m>13-38 = -25</m>, which is a multiple of 5.</p>

<definition xml:id="def-integers-modulo-n"><title>The Integers Modulo <m>n</m></title>
<idx>The Integers Modulo <m>n</m></idx>
<notation><usage><m>\mathbb{Z}_n</m></usage><description>the integers modulo <m>n</m></description></notation>
<statement><p>If <m>n</m> is a positive integer greater than one, we define the integers modulo <m>n</m> to be the set<m>\{0, 1, 2,. . ., n-1\}</m>. </p>
</statement></definition>


<definition xml:id="def-def-modular-addition"><title>Modular Addition</title>
<idx>Modular Addition</idx>
<notation><usage><m>a +_n b</m></usage><description>the mod <m>n</m> sum of <m>a</m> and <m>b</m></description></notation>
<statement><p>If <m>n</m> is a positive integer, we define addition modulo <m>n</m> <m>\left(+_n\right.</m>)
 as follows. If <m>a, b \in  \mathbb{Z}_n</m>,
<me>a +_n b = \textrm{ the remainder after } a + b \textrm{ is divided by } n</me></p>
</statement></definition>

<definition xml:id="def-def-modular-multiplication"><title>Modular Multiplication</title>
<idx>Modular Multiplication</idx>
<notation><usage><m>a \times_n b</m></usage><description>the mod <m>n</m> product of <m>a</m> and <m>b</m></description></notation>
<statement><p>If <m>n</m> is a positive integer, we define  multiplication modulo <m>n</m> <m>\left(\times_n\right.</m>) as follows. If <m>a, b \in  \mathbb{Z}_n</m>,
<me>a \times_n b = \textrm{ the remainder after } a \cdot b \textrm{ is divided by } n</me></p>
</statement></definition>

<note><p><ol marker="(a)">
<li><p>  The result of doing arithmetic modulo <m>n</m> is always an integer between 0 and <m>n-1</m>, by the Division Property. This observation implies that <m>\{0, 1,\dots, n-1\}</m> is closed under modulo <m>n</m> arithmetic.</p></li>
<li><p>  It is always true that <m>a +_n b \equiv  (a + b) \pmod{n}</m> and <m>a\times_n b \equiv  (a \cdot  b) \pmod{n}</m>.   For example,
<m>4 +_7 5 = 2 \equiv  9 \pmod{7}</m> and  

<m>4 \times_7  5 =  6 \equiv  20 \pmod{7}</m>.</p></li>
<li><p>One interpretation of <m>\mathbb{Z}_n</m> is that each element is a <em>representative</em> of its equivalence class with respect to congruence modulo <m>n</m>.  For example, if <m>n=7</m>, the number <m>1</m> in <m>\mathbb{Z}_7</m> really represents all numbers in <m>[1]={1+7k : k\in \mathbb{Z}}</m>.  In doing modular arithmetic, we can temporarily replace elements of <m>\mathbb{Z}_n</m> with other elements in their equivalence class modulo <m>n</m>. </p></li>
</ol>
</p>
</note>

<example xml:id="ex-11-4-modular"><title>Some Examples</title><p><ol marker="(a)">
<li><p> We are all somewhat familiar with <m>\mathbb{Z}_{12}</m> since the hours of the day are counted using this group, except for the fact that 12 is
used in place of 0.  Military time uses the mod 24 system and does begin at 0.  If someone started a four-hour trip at hour 21, the time at which
she would arrive is <m>21 +_{24} 4 = 1</m>. If a satellite orbits the earth every four hours and starts its first orbit at hour 5, it would end its
first orbit at time  <m>5 +_{24}4 =9</m>. Its tenth orbit would end at <m>5 +_{24} 10\times_{24}4 =21</m> hours on the clock</p></li>
<li><p> Virtually all computers represent unsigned integers in binary form with a fixed number of digits. A very small computer might reserve seven bits
to store the value of an integer. There are only <m>2^7</m> different values that can be stored in seven bits. Since the smallest value is 0, represented
as 0000000, the maximum value will be <m>2^7 - 1 = 127</m>, represented as 1111111. When a command is given to add two integer values, and the two values
have a sum of 128 or more, overflow occurs. For example, if we try to add 56 and 95, the sum is an eight-digit binary integer 10010111. One common
procedure is to retain the seven lowest-ordered digits. The result of adding 56 and 95 would be <m>0010111_{\textrm{ two}} = 23 \equiv  56 + 95\pmod{128}</m>. Integer arithmetic with this computer would actually be modulo 128 arithmetic.</p></li>
</ol>
</p></example>

</subsection>
<subsection xml:id="ss-properties-modular-arithmetic"><title>Properties of Modular Arithmetic</title><idx><h>Modular Arithmetic</h><h>Properties</h></idx>

<theorem xml:id="theorem-modular-add-inverse"><title>Additive Inverses in <m>\mathbb{Z}_n</m></title>
<statement><p>If <m>a \in  \mathbb{Z}_n</m>, <m>a\neq 0</m>, then the additive inverse of a is <m>n - a</m>.</p></statement><proof><p><m>a + (n - a) =n\equiv 0(\textrm{ mod } n)</m>, since  <m>n = n\cdot 1 + 0</m>.  Therefore,  <m>a+_n(n-a)=0</m>.</p></proof></theorem>  

<p>Addition modulo <m>n</m> is always commutative and associative; 0 is the identity for <m>+_n</m> and every element of <m>\mathbb{Z}_n</m> has an additive
inverse.  These properties can be summarized by noting that for each <m>n\geq 1</m>, <m>\left[\mathbb{Z}_n; +_n\right]</m> is a group.</p>

<definition>
	<title>The Additive Group of Integers Modulo <m>n</m></title>
	<idx><h>Integers Modulo <m>n</m></h><h>Additive Group</h></idx>
	<notation><usage><m>\mathbb{Z}_n</m></usage><description>The Additive Group of Integer Modulo <m>n</m></description></notation>
	<statement>
		<p>The Additive Group of Integers Modulo <m>n</m> is the group with domain <m>\{0, 1, 2, \dots, n-1\}</m> and with the operation of mod <m>n</m> addition.
		It is  denoted as <m>\mathbb{Z}_n</m>.</p>
	</statement>
</definition>


<p>Multiplication modulo <m>n</m> is always commutative and associative, and 1 is the identity for <m>\times_n</m>.</p>

<p>Notice that the algebraic properties of <m>+_n</m> and <m>\times_n</m> on <m>\mathbb{Z}_n</m> are identical to the properties of addition and multiplication on <m>\mathbb{Z}</m>.</p>

<p>Notice that a group cannot be formed from the whole set <m>\{0, 1, 2, \dots, n-1\}</m> with mod <m>n</m> multiplication since zero never has a multiplicative inverse.  Depending on the value of <m>n</m> there may be other numbers that will be excluded. </p>

<definition>
	<title>The Multiplicative Group of Integers Modulo <m>n</m></title>
	<idx><h>Integers Modulo <m>n</m></h><h>Multiplicative Group</h></idx>
	<notation><usage><m>\mathbb{U}_n</m></usage><description>The Multiplicative Group of Integer Modulo <m>n</m></description></notation>
	<statement>
		<p>The Multiplicative Group of Integers Modulo <m>n</m> is the group with domain <m>\{k\in \mathbb{Z} \vert  1 \leq k \leq n-1 \textrm{ and }\gcd(n,k)=1\}</m> and with the operation of mod <m>n</m> multiplication.  It is  denoted as <m>\mathbb{U}_n</m>.</p>
	</statement>
</definition>
<example xml:id="ex-11-4-op-tables"><title>Some operation tables</title>
<p> </p>
<sidebyside  widths="40% 40%" margins="auto">
<p>Here are examples of operation tables for modular groups. Notice that although 8 is greater than 5, the two groups <m>\mathbb{U}_5</m> and <m>\mathbb{U}_8</m> both have order 4. In the case of <m>\mathbb{U}_5</m>, since 5 is prime all of the nonzero elements of <m>\mathbb{Z}_5</m> are included.  Since 8 isn't prime we don't include integers that share a common factor with 8, the even integers in this case.
</p>
				<table>
				  <title>Operation Table for the group <m>\mathbb{Z}_5</m></title>
				  <tabular halign="center">
					<row bottom="minor" >
					  <cell right="minor"><m>+_5</m></cell>
					  <cell><m>0</m></cell>
					  <cell><m>1</m></cell>
					  <cell><m>2</m></cell>
					  <cell><m>3</m></cell>
					   <cell><m>4</m></cell>
				   </row>
					<row>
					  <cell right="minor">0</cell>
					  <cell>0</cell>
					  <cell>1</cell>
					  <cell>2</cell>
					  <cell>3</cell>
					  <cell>4</cell>
					</row>
					<row>
					  <cell right="minor">1</cell>
					  <cell>1</cell>
					  <cell>2</cell>
					  <cell>3</cell>
					  <cell>4</cell>
					  <cell>0</cell>
					</row>
					<row>
					  <cell right="minor">2</cell>
					  <cell>2</cell>
					  <cell>3</cell>
					  <cell>4</cell>
					  <cell>0</cell>
					  <cell>1</cell>
					</row>
					<row>
					  <cell right="minor">3</cell>
					  <cell>3</cell>
					  <cell>4</cell>
					  <cell>0</cell>
					  <cell>1</cell>
					  <cell>2</cell>
					</row>
					<row>
					  <cell right="minor">4</cell>
					  <cell>4</cell>
					  <cell>0</cell>
					  <cell>1</cell>
					  <cell>2</cell>
					  <cell>3</cell>
					</row>
				  </tabular>
				</table>
</sidebyside>
<sidebyside  widths="40% 40%" margins="auto">
				<table>
				  <title>Operation table for the group <m>\mathbb{U}_5</m></title>
				  <tabular halign="center">
					<row bottom="minor" >
					  <cell right="minor"><m>\times_5</m></cell>
					  <cell><m>1		</m></cell>
					  <cell><m>2</m></cell>
					  <cell><m>3</m></cell>
					   <cell><m>4</m></cell>
				   </row>
					<row>
					  <cell right="minor">1</cell>
					  <cell>1</cell>
					  <cell>2</cell>
					  <cell>3</cell>
					  <cell>4</cell>
					</row>
					<row>
					  <cell right="minor">2</cell>
					  <cell>2</cell>
					  <cell>4</cell>
					  <cell>1</cell>
					  <cell>3</cell>
					</row>
					<row>
					  <cell right="minor">3</cell>
					  <cell>3</cell>
					  <cell>1</cell>
					  <cell>4</cell>
					  <cell>2</cell>
					</row>
					<row>
					  <cell right="minor">4</cell>
					  <cell>4</cell>
					  <cell>3</cell>
					  <cell>2</cell>
					  <cell>1</cell>
					</row>
				  </tabular>
				</table>
				<table>
				  <title>Operation table for the group <m>\mathbb{U}_8</m></title>
				  <tabular halign="center">
					<row bottom="minor" >
					  <cell right="minor"><m>\times_8</m></cell>
					  <cell><m>1		</m></cell>
					  <cell><m>3</m></cell>
					  <cell><m>5</m></cell>
					   <cell><m>7</m></cell>
				   </row>
					<row>
					  <cell right="minor">1</cell>
					  <cell>1</cell>
					  <cell>3</cell>
					  <cell>5</cell>
					  <cell>7</cell>
					</row>
					<row>
					  <cell right="minor">3</cell>
					  <cell>3</cell>
					  <cell>1</cell>
					  <cell>7</cell>
					  <cell>5</cell>
					</row>
					<row>
					  <cell right="minor">5</cell>
					  <cell>5</cell>
					  <cell>7</cell>
					  <cell>1</cell>
					  <cell>3</cell>
					</row>
					<row>
					  <cell right="minor">7</cell>
					  <cell>7</cell>
					  <cell>5</cell>
					  <cell>3</cell>
					  <cell>1</cell>
					</row>
				  </tabular>
				</table>

</sidebyside>

</example>

<p><em>Computing Modular Multiplicative Inverses.</em>
Unlike the nice neat formula for additive inverses mod <m>n</m>, multiplicative inverses can most easily computed by applying <xref ref="theorem-11-4-1" text="title"/>.  If <m>a</m> is an element of the group <m>\mathbb{U}_n</m>, then by definition <m>\gcd(n,a)=1</m>, and so there exist integers <m>s</m> and <m>t</m> such that <m>1 = n s + a t</m>.  They can be computed with the Extended Euclidean Algorithm. 
<me>1 = n s + a t  \Rightarrow   a t = 1 +(-s)n  \Rightarrow  a \times_n t =1</me>
Since <m>t</m> might not be in <m>\mathbb{U}_n</m> you might need take the remainder after dividing it by <m>n</m>.  Normally, that involves simply adding <m>n</m> to <m>t</m>.</p>
<p>For example, in <m>\mathbb{U}_{2048}</m>, if we want the muliplicative inverse of <m>1001</m>, we run the Extended Euclidean Algorithm and find that 
	<me>\gcd(2048,1001) = 1 =457\cdot 2048+ (-935)\cdot 1001 </me>
Thus, the multiplicative inverse of 1001 is  <m>2048-935 = 1113</m>.  See the SageMath Note below to see how to run the Extended Euclidean Algorithm.</p>
</subsection>
<subsection xml:id="ss-sage-modular"><title>SageMath Note - Modular Arithmetic</title><idx><h>SageMath Note</h><h>Modular Arithmetic</h></idx>
<p>Sage inherits the basic integer division functions from Python that compute a quotient and remainder in integer division.  For example, here is how to divide 561 into 2017 and get the quotient and remainder.</p>
<sage>
<input>
a=2017
b=561
[q,r]=[a//b,a%b]
[q,r]
</input>
<output>
[3, 334]
</output>
</sage>
<p>In Sage, <m>gcd</m> is the greatest common divisor function.  It can be used in two ways.  For the gcd of 2343 and 4319 we can evaluate the expression
<m>gcd(2343,4319)</m>.   If we are working with a fixed modulus <m>m</m> that has a value established in your Sage session, the expression <m>m.gcd(k)</m>
to compute the greatest common divisor of <m>m</m> and any integer value <m>k</m>. The extended Euclidean algorithm can also be called upon with <m>xgcd</m>:</p>
<sage>
<input>
a=2017
b=561
print(gcd(a,b))
print(xgcd(a,b))
</input>
<output>
1
(1, -173, 622)
</output>
</sage>
<p>Sage has some extremely powerful tool for working with groups.  The integers modulo <m>n</m> are represented by the expression <m>Integers(n)</m>
and the addition and multiplications tables can be generated as follows.</p>
<sage>
<input>
R = Integers(6)
print(R.addition_table('elements'))
print(R.multiplication_table('elements'))
</input>
<output>
+  0 1 2 3 4 5
 +------------  
0| 0 1 2 3 4 5
1| 1 2 3 4 5 0
2| 2 3 4 5 0 1
3| 3 4 5 0 1 2
4| 4 5 0 1 2 3
5| 5 0 1 2 3 4

*  0 1 2 3 4 5
 +------------
0| 0 0 0 0 0 0
1| 0 1 2 3 4 5
2| 0 2 4 0 2 4
3| 0 3 0 3 0 3
4| 0 4 2 0 4 2
5| 0 5 4 3 2 1
</output>
</sage>
<p>Once we have assigned <m>R</m> a value of <m>Integers(6)</m>,  we can do calculations by wrapping <m>R()</m> around the integers 0 through 5.  Here is
a list containing the mod 6 sum and product, respectively, of 5 and 4:</p>
<sage>
<input>
[R(5)+R(4), R(5)*R(4)]
</input>
<output>
[3, 2]
</output>
</sage>
<p>Generating the multiplication table for the family of groups <m>\mathbb{U}_n</m> takes a bit more code.  Here we restrict the allowed inputs to be integers from 2 to 64.</p>
<sage>
<input>
def U_table(n):
    if n.parent()!=2.parent() or n &lt; 2 or n &gt; 64:
        return "input error/out of range"
    R=Integers(n)
    els=[]
    for k in filter(lambda k:gcd(n,k)==1,range(n)):
        els=els+[str(k)]
    return R.multiplication_table(elements=els,names="elements")
    
U_table(18)
</input>
<output>
 *   1  5  7 11 13 17
  +------------------
 1|  1  5  7 11 13 17
 5|  5  7 17  1 11 13
 7|  7 17 13  5  1 11
11| 11  1  5 13 17  7
13| 13 11  1 17  7  5
17| 17 13 11  7  5  1
</output>
</sage>
</subsection>
<exercises xml:id="exercises-11-4">
<title>Exercises</title>
<exercise number="1"><statement><p> Determine the greatest common divisors of the following pairs of integers without using any computational assistance.

<ol marker="(a)">
<li><p>  <m>2^3 \cdot 3^2\cdot 5</m>   and  <m>2^2 \cdot 3 \cdot 5^2\cdot 7</m></p></li>
<li><p>   <m>7! </m>  and  <m>3\cdot 5\cdot 7\cdot 9\cdot 11\cdot 13</m></p></li>
<li><p>  <m>19^4</m>  and  <m>19^5</m></p></li>
<li><p>  12112 and 0</p></li>
</ol>
</p></statement>
<answer><p>
<ol marker="(a)">
<li><p>  <m>2^2 \cdot 3 \cdot 5</m></p></li>
<li><p>   <m>3^2 \cdot 5\cdot 7</m></p></li>
<li><p>  <m>19^4</m> </p></li>
<li><p>  12112</p></li>
</ol>
</p>
</answer>
</exercise>
<exercise number="2"><statement><p> Find all possible values of the following, assuming that <m>m</m> is a positive integer.
<ol marker="(a)">
<li><p>  <m>\gcd(m+1,m)</m></p></li>
<li><p>  <m>\gcd(m+2,m)</m></p></li>
<li><p>  <m>\gcd(m+4,m)</m></p></li>
</ol>
</p></statement></exercise>
<exercise number="3"><statement><p> Calculate:
<ol marker="(a)"  cols="2">
<li><p> <m>7 +_8 3</m></p></li>
<li><p> <m>7 \times_8 3</m></p></li>
<li><p> <m>4\times_8 4</m></p></li>
<li><p> <m>10+_{12} 2</m></p></li>
<li><p> <m>6\times_8 2 +_8 6\times_8 5 </m></p></li>
<li><p> <m>6\times_8 \left(2 +_85\right)</m></p></li>
<li><p>  <m>3 \times_5  3 \times_5  3 \times_5  3 \equiv  3^4 (\textrm{ mod} 5)</m> </p></li>
<li><p>  <m>2 \times_{11}7</m></p></li>
<li><p>    <m>2 \times_{14}7</m></p></li>
</ol>
</p></statement>
<answer><p><ol marker="(a)" cols="4">
<li><p> 2</p></li>
<li><p> 5 </p></li>
<li><p> 0</p></li>
<li><p> 0 </p></li>
<li><p> 2 </p></li>
<li><p> 2</p></li>
<li><p> 1 </p></li>
<li><p> 3</p></li>
<li><p> 0</p></li>
</ol> 
</p></answer></exercise>
<exercise number="4"><statement><p> List the additive inverses of the following elements:
<ol marker="(a)">
<li><p>  4, 6, 9 in <m>\mathbb{Z}_{10}</m></p></li>
<li><p> 16, 25, 40 in <m>\mathbb{Z}_{50}</m></p></li>
</ol>
</p></statement></exercise>
<exercise number="5"><statement><p>In the group <m>\mathbb{Z}_{11}</m> , what are:
<ol marker="(a)">
<li><p>  3(4)?</p></li>
<li><p>  36(4)?</p></li>
<li><p> How could you efficiently compute <m>m(4)</m>, <m>m \in  \mathbb{Z}</m>?</p></li>
</ol>
</p></statement>
<answer><p><ol marker="(a)" cols="2">
<li><p> 1</p></li>
<li><p>1</p></li>
<li><p><m>m(4) = r(4)</m>, where <m>m = 11 q + r</m>, <m>0 \leq  r &lt; 11</m></p></li>
</ol>
</p></answer></exercise>
<exercise number="6"><statement><p>When defining  notice that we could define this operation on all integers, but we restricted the set to <m>\mathbb{Z}_n</m> to satisfy the properties of a group.  Can you explain what goes wrong if we define  <m>+_n</m> on all of the integers?
</p></statement>
<answer component="im">
<p>The first thing that goes wrong is that <m>0</m> will not be an identity for addition modulo <m>n</m> on the whole set of integers.  Notice that <m>0+_n n=0 \neq n</m>.</p>
</answer></exercise>
<exercise number="7"><statement><p>A student is asked to solve the following equations under the requirement that all arithmetic should be done in <m>\mathbb{Z}_2</m>. List all solutions.
<ol marker="(a)">
<li><p>  <m>x^2 + 1 = 0</m>.</p></li>
<li><p>  <m>x^2 + x + 1 = 0</m>.</p></li>
</ol>
</p></statement><answer><p> Since the solutions, if they exist, must come from <m>\mathbb{Z}_2</m>, substitution is the easiest approach.
<ol marker="(a)">
<li><p> 1 is the only solution, since  <m>1^2+_21=0</m>   and  <m>0^2+_21=1</m></p></li>
<li><p> No solutions, since <m>0^2+_2 0+_2 1=1</m>, and  <m>1^2+_2 1+_2 1=1</m></p></li>
</ol>
</p></answer></exercise>
<exercise number="8"><statement><p> Determine the solutions of the same equations as in Exercise 5 in <m>\mathbb{Z}_5</m>. 
</p></statement></exercise>
<exercise number="9" xml:id="exercise_u_n"><statement><p>
<ol marker="(a)">
<li><p>Write out the operation table for <m>\times_14</m> on <m>\{1,3,5,9,11,13\}</m>, and convince your self that this is a group.</p></li>
<li><p>Let <m>\mathbb{U}_{n}</m> be the elements of <m>\mathbb{Z}_{n}</m> that have inverses with respect to <m>\times_{n}</m>.  Convince yourself that <m>\mathbb{U}_{n}</m> is a group under <m>\times_{n}</m>. </p></li>
<li><p>Prove that the elements of <m>\mathbb{U}_{n}</m>  are those elements  <m>a\in \mathbb{Z}_{n} </m> such that <m>\gcd(n,a)=1</m>.  You may use  <xref ref="theorem-11-4-1" text="type-global"/> in this proof.</p></li>
</ol>
</p>
</statement>
</exercise> 
<exercise number="10"><statement><p> Prove the division property, <xref ref="th-division-property" text="type-global"/>.
</p></statement>
<hint>
<p>Prove by induction on <m>m</m> that you can divide any positive integer into <m>m</m>. That is, let <m>p(m)</m> be <q>For all
<m>n</m> greater than zero, there exist unique integers <m>q</m> and <m>r</m> such that <m>\dots</m> .</q>  In the induction step, divide
<m>n</m> into <m>m - n</m>.</p>
</hint></exercise>
<exercise number="11"><statement><p>Suppose <m>f:\mathbb{Z}_{17}\to \mathbb{Z}_{17}</m> such <m>f(i)=a \times_{17} i +_{17} b </m> where <m>a</m> and <m>b</m> are integer constants. Furthermore,  assume that <m>f(1)=11</m> and <m>f(2)=4</m>. Find a formula for <m>f(i)</m> and also find a formula for the inverse of <m>f</m>.
</p></statement>
<solution><p>The given conditions can be converted to a system of linear equations:
<me>\begin{array}{c}
f(1)=11 \Rightarrow   a +_{17} b = 11\\
f(2)=4  \Rightarrow  2 \times_{17} a +_{17} b =4\\
\end{array}
</me></p>
<p>If we subtract the first equation from the second, we get  <m>a = 4 +_{17} (-11) = 4 +_{17} 6= 10</m>.  This implies that <m>b=1</m>, and <m>f(i) = 10\times+{17}i + 1</m>.  To get a formula for the inverse of <m>f</m> we solve <m>f(j)=i</m> for <m>j</m>, using the fact that the multiplicative inverse of 10 (mod 17) is 12. 
<me>\begin{split}
	f(j)=i &amp; \Rightarrow 10\times+{17}j + 1 = i\\
		&amp; \Rightarrow    10\times+{17}j  = i +_{17} 16\\
		&amp; \Rightarrow     j = 12\times_{17}( i +_{17} 16)\\
	\end{split}
</me>
Therefore  <m>f^{-1}(i) = 12\times_{17}( i +_{17} 16) = 12\times_{17} i +_{17} 5</m>.</p>
</solution>
</exercise>
		
<exercise  number="12">
			<statement><p>Write out the operation table for mod 10 multiplication on
				 <m>T=\{0,2,4,6,8\}</m>. Is <m>[T;\times_{10}]</m>	 a monoid? Is it a group?</p>
			</statement>
			<solution><p>This system is a monoid with identity 6 (surprise!).  However it is not a group since 0 has no inverse.</p></solution>
</exercise>

<exercise  number="13">
			<statement><p>Given that <m>1 = 2021\cdot(-169) +450 \cdot 759</m>, explain why <m>450</m> is an element of the group <m>\mathbb{U}_{2021}</m> and determine its inverse in that group.</p>
			</statement>
			<solution><p>By <xref ref="theorem-11-4-1" text="title"/>, <m>450</m> is an element of  <m>\mathbb{U}_{2021}</m>.  It's inverse in the group is <m>759</m> because 
			<me>450 \cdot 759 = 2021\cdot 169 +1 \quad \Rightarrow \quad 450 \times_{2021} 759 =1.</me>
			</p></solution>
</exercise>
<exercise  number="14">
			<statement><p>Let <m>n=2021</m>.  Solve <m>450 \times_{n} x = 321</m> for <m>x</m> in the group  <m>\mathbb{U}_{n}</m></p>
			</statement>
<!-- 
			<solution><p>
			</p></solution>
 -->
</exercise>
<exercise  number="15">
			<statement><p>Let <m>p</m> be an odd prime.  
			Find all solutions to the equation <m>x^2 =x \times_n x =1</m> in the group <m>\mathbb{U}_{p}</m>.</p>
			</statement>
<!-- 
			<solution><p>
			</p></solution>
 -->
</exercise>

<exercise  number="16">
			<statement><p>It was observed above that in doing modular arithmetic, one can replace an element of <m>\mathbb{Z}_n</m> with any other element of its equivalence class modulo <m>n</m>.  For example, if one is computing <m>452 \times_{461} 7</m>, the alternative to multiplying <m>452</m> time <m>7</m> and then dividing by <m>461</m> to get the remainder in <m>\mathbb{Z}_{461}</m>, we can replace <m>452</m> with <m>-9</m> and get a product of <m>-63</m> which is conguent of <m>398</m>.  Use this <q>trick</q> to compute the following without the use of a calculator.</p>
<p>
			<ol marker="(a)">
			<li><p><m>898 \times_{1001} 998</m> </p></li>
			<li><p><m>77^{10} \mod{81} </m> </p></li>
			<li><p>The solution to <m>196 \times_{197} x = 120</m> </p></li>
</ol>
</p>
			
			</statement>
<!-- 
			<solution><p>
			</p></solution>
 -->
</exercise>

<exercise  number="17">
			<statement><p>We associate the set <m>\mathbb{Z}_n= \{0, 1,2, \text{...}, n-1\}</m> with the addition modulo <m>n</m>, <m>+_n</m>, because the pair <m>\left[\mathbb{Z}_n; +_n\right]</m> form a group.  Why must we use a matching modulus? Explain why by considering the following two examples.
			<ol marker="(a)">
			<li><p><m>\left[\mathbb{Z}_3, +_2\right]</m></p></li>
			<li><p><m>\left[\mathbb{Z}_3, +_4\right]</m></p></li>
			</ol>
</p>
			
			</statement>
</exercise>

</exercises>
</section>